
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <title>BarCode Scanner - PhoneGapPro.com</title>
 <script type="text/javascript" src="cordova.js"></script>
 <script type="text/javascript">
 function scan(){
 console.log("clicked");
 cordova.plugins.barcodeScanner.scan(function(result){
 //success callback

//alert(JSON.stringify(result));
// the barcodeScanner app returns a json file comprising an array of three items: {"cancelled":0, "text":"THE ISBN NUMBER", "format":"isbn format"} and these are stored in the result variable. To access the isbn number, we select the second item in the array: result["text"] 

// build and display the url
var txt = (JSON.stringify(result));
document.getElementById("demo2").innerHTML = "http://isbndb.com/api/v2/json/K1XA9ULM/book/".concat(result["text"]);


var html1 = "<a href=\"http://isbndb.com/api/v2/json/K1XA9ULM/book/";
var html2 = "\" target=\"_blank\">here</a>";

//var txt = (JSON.stringify(result));

var more = result["text"];

var total = html1.concat(more).concat(html2);

//full url plus a href link 
document.getElementById("demo").innerHTML = total;

//full url only
var urlOnly = "http://isbndb.com/api/v2/json/K1XA9ULM/book/";
var fullURL = urlOnly.concat(more);

//alert (fullURL);

document.cookie = 'myURL=' +fullURL+'; expires=Wed, 1 Jan 2070 13:47:11 UTC;'; 

//document.cookie = 'sconName='+changedName+'; expires=Wed, 1 Jan 2070 13:47:11 UTC; path=/'


document.getElementById("openBrowser").addEventListener("click", openBrowser);

//code to open link in external browser

function openBrowser() {
   var x = document.cookie;
   //alert(x);
   var url = x.slice(6);
   //alert(url);
   var target = '_blank';
   var options = "location=yes"
   var ref = cordova.InAppBrowser.open(url, target, options);

   ref.addEventListener('loadstart', loadstartCallback);
   ref.addEventListener('loadstop', loadstopCallback);
   ref.addEventListener('loadloaderror', loaderrorCallback);
   ref.addEventListener('exit', exitCallback);

   function loadstartCallback(event) {
      console.log('Loading started: '  + event.url)
   }

   function loadstopCallback(event) {
      console.log('Loading finished: ' + event.url)
   }

   function loaderrorCallback(error) {
      console.log('Loading error: ' + error.message)
   }

   function exitCallback() {
      console.log('Browser is closed...')
   }
}

 });
 }
 </script>
</head>
<body>
 <h3>BAR CODE SCANNER</h3>
 <button onclick="scan()">SCAN</button>
<p id="demo2"></p>
<p id="demo"></p>
<div  id="openBrowser">open</div>

</body>
</html>